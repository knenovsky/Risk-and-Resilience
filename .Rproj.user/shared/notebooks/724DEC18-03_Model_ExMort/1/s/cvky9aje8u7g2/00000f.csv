"0","table2019_pc<-dimred_250 %>% filter(year%in%2019)"
"0","table2020_pc<-dimred_250 %>% filter(year%in%2020) "
"0","table2019_pc2<-table2019_pc %>% mutate(identifier=paste0(`Country Code`,""2020""))"
"0","table2020_pc2<-table2020_pc %>% mutate(identifier=paste0(`Country Code`,""2021""))"
"0","WDI_pc_2020_2021<-rbind(table2019_pc2,table2020_pc2) %>%  filter(!is.na(iso1))"
"0","Xgboostinput<- dplyr::inner_join(WDI_pc_2020_2021, excessCounrty_annual2, by = ""identifier"")"
"0","Xgboostinput<-Xgboostinput %>% dplyr::select(`Country Code`,`p_value_mort`,`identifier`,paste0(""PC_normal_"",seq(1:20)))"
"0","Xgboostinput %>%  filter(!(`Country Code`%in% ""PER""))-> Xgboostinput"
"0",""
"0","## OWID add"
"0","Xboostinput_exmort_owid<-owid_annual %>% rename("
"0","  ""Oxford Stringency Index""=""Stringency_index"","
"0","  ""Covid cases per million""=""Covid_Cases_per_million"","
"0","  ""Age > 65 (%)""=aged_65_older,"
"0","  ""HDI""=human_development_index,"
"0","  ""Cardiovasc death rate""=cardiovasc_death_rate,"
"0","  ""Pop dens""=population_density,"
"0","  ""Diabetetes (%)""=diabetes_prevalence,"
"0","  ""Age (Median)""=""Median_age"") %>% "
"0","  dplyr::select(any_of(features_final),all_of(""identifier"")) %>%"
"0","  mutate_all(~ifelse(is.nan(.), NA, .)) %>% "
"0","  inner_join(Xgboostinput , .  ,by=""identifier"")"
"0","  "
"0","covar2020<-covar %>% rename("
"0","    ""Urban area (%)"" =""urban_percent"", "
"0","    ""Med. Infr""= ""Med_recources_m"","
"0","    ""UHC index""=""med_UHD"", "
"0","    ""Life expectancy""=""life_expectancy"","
"0","    ""Mortality index""=""mortality_m"", "
"0","    ""Digitalisation Index""= ""digitalisation_1"","
"0","    ""Health spending""=""health_spending_percent"","
"0","    ""Obesity (%)""= ""obesity"", "
"0","    ""Basic Immunization""=""immunization_bad"","
"0","    ""Comorbidity index""=""comorb_m_unscaled"", "
"0","    ""Air pollution""=""airpolution_avg"") %>% mutate(identifier=paste0(`Country Code`,""2020"")) "
"0","covar20202021<-rbind(covar2020,covar2020%>% mutate(identifier=paste0(`Country Code`,""2021"")))"
"0",""
"0",""
"0","Xboostinput_exmort_owid_covar<- covar20202021 %>%  dplyr::select(any_of(features_final),all_of(""identifier"")) %>% "
"0","  inner_join(Xboostinput_exmort_owid , .  ,by=""identifier"") "
"0","  "
"0",""
"0",""
"0","a<-pcaMethods::pca(Xboostinput_exmort_owid_covar,method = ""ppca"")"
"0","Xboostinput_exmort_owid_covar_imputed<-a@completeObs "
"0","colnames(Xboostinput_exmort_owid_covar_imputed)<-colnames(Xboostinput_exmort_owid_covar %>% dplyr::select(-`Country Code`,-identifier))"
"0",""
"0","# income_ex<-Xboostinput_exmort_owid_covar %>% na.omit()"
"0","# income_ex"
"0",""
"0","# pca"
"0","Xgboostinput_complete_pca<-cbind(Xgboostinput %>% dplyr::select(`Country Code`),Xboostinput_exmort_owid_covar_imputed)"
"0","# Xgboostinput_complete_pca %>% #saveRDS(file = ""../data/03_data/XboostDfPCA.RDS"")"
"0","# iso"
"0",""
"0",""
"0","wdi_income_path<-file.path(WDI_DIR, ""CLASS.xlsx"") # Available on the Worldbank website. Clssification 20231103"
"0","incomegroups<-read_xlsx(wdi_income_path)"
"0",""
